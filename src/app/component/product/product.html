<div>
<p-table #dt1 [value]="allproduct" dataKey="id" [rows]="10" [rowsPerPageOptions]="[10, 25, 50]"  [paginator]="true" [globalFilterFields]="['id', 'brand', 'description', 'title']" showGridlines class="dataheadtab" >
    <ng-template #caption>
        <div class="flex">
            <p-button label="Clear" [outlined]="true" icon="pi pi-filter-slash" (click)="clear(dt1,searchinput)" />
            <p-iconfield iconPosition="left" class="ml-auto">
                <p-inputicon>
                    <i class="pi pi-search"></i>
                </p-inputicon>
                <input pInputText #searchinput type="text"  (input)="dt1.filterGlobal($event.target.value, 'contains')" placeholder="Search keyword" />
            </p-iconfield>
        </div>
    </ng-template>
    <ng-template  pTemplate="header">
        <tr>
            <th style="min-width:2rem">
                <div class="flex items-center justify-between">
                    Id
                   
                </div>
            </th>
            <th style="min-width:10rem">
                <div class="flex items-center justify-between" >
                    Title
                    
                </div>
            </th>
            <th style="min-width:10rem">
                <div class="flex items-center justify-between">
                    Brand
                </div>
            </th>
            <th style="min-width:15rem">
                <div class="flex items-center justify-between">
                    Description
                </div>
            </th>
          
            <th style="min-width:10rem">
                <div class="flex items-center justify-between">
                    Category
                </div>
            </th>
            
           
            <th style="min-width:8rem">
                <div class="flex items-center justify-between">
                    Price
                </div>
            </th>
           
            <th style="min-width:14rem">
                <div class="flex items-center justify-between">
                    Discount Percentage
                </div>
            </th> 
            <th style="min-width:10rem">
             <div class="flex items-center justify-between">
                 Image
             </div>
         </th>
             <th style="min-width:14rem">
                <div class="flex items-center justify-between">
                    Available
                </div>
            </th>   
        </tr>
    </ng-template>
    <ng-template pTemplate="body" let-product>
        <tr>
            <td>{{ product.id }}</td>
      <td style="text-decoration: underline;cursor: pointer;" (click)="showReviews(product)">{{ product.title }}</td>
      <td>{{ product.brand || 'Null' }}</td>
      <td>{{ product.description }}</td>
      
      <td>{{ product.category }}</td>
      <td>{{ product.price }}</td>
      <td>{{ product.discountPercentage }}</td>
      <td><img [src]="product.images?.[0]" [alt]="product.title" class="w-24 rounded" />  </td>
      <td>{{product.availabilityStatus}}</td>
    </tr>
    </ng-template>
    <ng-template pTemplate="emptymessage">
        <tr>
            <td colspan="7">No customers found.</td>
        </tr>
    </ng-template>
    
</p-table>


<p-dialog
  header="Product Reviews"
  [(visible)]="reviewDialogVisible"
  [modal]="true"
  [style]="{ width: '60rem' }"
  [draggable]="false"
>
  <p-table
    *ngIf="selectedProduct?.reviews"
    [value]="selectedProduct.reviews"
    
  >
    <ng-template pTemplate="header">
        <tr>
            <th pSortableColumn="reviewerName" style="width:20%">
                <div class="flex items-center gap-2">
                    Name
                    <p-sortIcon field="reviewerName" />
                </div>
            </th>
            <th pSortableColumn="reviewerEmail" style="width:20%">
                <div class="flex items-center gap-2">
                    Email
                    <p-sortIcon field="reviewerEmail
" />
                </div>
            </th>
            <th pSortableColumn="date" style="width:20%">
                <div class="flex items-center gap-2">
                    Date
                    <p-sortIcon field="date" />
                </div>
            </th>
            <th pSortableColumn="comment" style="width:20%">
                <div class="flex items-center gap-2">
                    comment
                    <p-sortIcon field="comment" />
                </div>
            </th>
             <th pSortableColumn="rating" style="width:20%">
                <div class="flex items-center gap-2">
                    rating
                    <p-sortIcon field="rating" />
                </div>
            </th>
        </tr>
    </ng-template>
    <ng-template *ngIf="selectedProduct.reviews?.length > 0;" pTemplate="body" let-review>
        <tr >
            <td>{{ review.reviewerName }}</td>
      <td>{{ review.reviewerEmail }}</td>
      <td>{{ review.date | date: 'mediumDate' }}</td>
      <td>{{ review.comment }}</td>
        <td><p-rating [(ngModel)]="review.rating" [readonly]="true"  /></td>
        </tr>
    </ng-template>
    <p *ngIf="!selectedProduct?.reviews?.length">
  No reviews available.
</p>
</p-table>
</p-dialog>
<p-scrolltop
  target="window"
  [threshold]="100"
  icon="pi pi-arrow-up"
  [buttonProps]="{ severity: 'contrast', raised: true, rounded: true }">
</p-scrolltop>


</div>
